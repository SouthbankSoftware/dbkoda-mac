{"version":3,"sources":["../src/runUat.workflow.js"],"names":["app","cwd","helpers","remoteExec","then","l","notice","catch","Promise","reject"],"mappings":";;;;;;AAOA;;;;AACA;;;;;;AARA;;;;;;;kBAUe,UAACA,GAAD,EAAMC,GAAN,EAAWC,OAAX,EAAuB;AAAA,MAC5BC,UAD4B,GACbD,OADa,CAC5BC,UAD4B;;AAEpC,SAAO,+BAAgBH,GAAhB,EAAqBC,GAArB,EAA0BC,OAA1B,EACJE,IADI,CACC,YAAM;AACVC,MAAEC,MAAF,CAAS,gBAAT;AACA,WAAOH,WACL,sRADK,CAAP;AAGD,GANI,EAOJC,IAPI,CAOC;AAAA,WAAM,uBAAQJ,GAAR,EAAaC,GAAb,EAAkBC,OAAlB,CAAN;AAAA,GAPD,EAQJK,KARI,CAQE;AAAA,WAAM,uBAAQP,GAAR,EAAaC,GAAb,EAAkBC,OAAlB,EAA2BE,IAA3B,CAAgC;AAAA,aAAMI,QAAQC,MAAR,CAAe,CAAf,CAAN;AAAA,KAAhC,CAAN;AAAA,GARF,CAAP;AASD,C","file":"runUat.workflow.js","sourcesContent":["/**\n * @Author: guiguan\n * @Date:   2017-05-12T12:30:55+10:00\n * @Last modified by:   guiguan\n * @Last modified time: 2017-06-24T00:41:10+10:00\n */\n\nimport buildController from './buildController.workflow';\nimport cleanup from './cleanup.workflow';\n\nexport default (app, cwd, helpers) => {\n  const { remoteExec } = helpers;\n  return buildController(app, cwd, helpers)\n    .then(() => {\n      l.notice('Running UAT...');\n      return remoteExec(\n        'cd app && (cd build/controller && (yarn unlink > /dev/null 2>&1; exit 0) && yarn link) && yarn link \"@southbanksoftware/dbkoda-controller\" && yarn install --no-progress && yarn run eslint && yarn mac:gainKeychainAccess && yarn run pack && NODE_ENV=production CI=true yarn jest'\n      );\n    })\n    .then(() => cleanup(app, cwd, helpers))\n    .catch(() => cleanup(app, cwd, helpers).then(() => Promise.reject(1)));\n};\n"]}